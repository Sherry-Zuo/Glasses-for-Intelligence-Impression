---
title: "Glasses For Letter Grade Impression"
subtitle: BA830 - Fall 2019
author: "team 7"
date: "12/13/2019"
output: pdf_document
---

**Team 7 Members:** Kunpeng Huang, Yoki Liu, Lyufan Pan, Yunlei Zhou, Jiayuan Zou, Sherry Zuo

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=1, digits=8)
```

Key Elements of Project Writeup
When you write up your project paper, there is no predefined format. However, these factors must be included:
a. Your causal question of interest.  
b. Your experimental design and what data you collected.  
c. Why you chose the experiment design.  
d. Summary statistics about the data.  
e. Treatment effects.  
f. Limitations of your study.  
Make sure the paper is well-written and that there are figures and tables that are easy to understand.

```{r}
library(data.table)
library(tidyverse)
library(lfe)
library(lubridate)
library(stargazer)
library(gridExtra)
library(naniar)
```

```{r}
smart <- fread("survey.csv")
```

```{r}
skimr::skim(smart)
```

```{r}
head(smart, 2)
```

```{r}
smart=smart%>%select(-Status, -DistributionChannel, -RecipientEmail, -RecipientFirstName, -RecipientLastName, -ExternalReference, -UserLanguage)
```

```{r}
smart=smart%>%filter(Finished=="True")%>%filter(Progress==100)
```

```{r}
smart=smart%>%select(-Progress, -Finished)
```

```{r}
length(unique(smart$ResponseId))
length(unique(smart$IPAddress))
```
So, some people take more than once, we only want to keep each person once.
```{r}
smart=smart%>%distinct(IPAddress, .keep_all = TRUE)
```
```{r}
# Add treatment/control dummy variable:
smart2 = smart %>% 
  mutate(Treatment = ifelse(`Q4.1_First Click`=="", FALSE, TRUE))

# Variable selection:
smart_cleaned = smart2 %>% 
  select(-c(`Q2.1_First Click`:`Q2.1_Click Count`, `Q3.1_First Click`:`Q3.1_Click Count`, 
            `Q4.1_First Click`:`Q4.1_Click Count`, Q48, IPAddress, StartDate, EndDate, ResponseId)) %>% 
  select(1:8, 
         class_baseline=Q2.3, personality_baseline=Q2.4, grade_baseline=Q2.5, 
         gender_p=Q5.1, class_p=Q5.2, personality_p=Q5.3, grade_p=Q5.4,
         everything())
```

```{r}
control = smart_cleaned %>% 
  filter(Treatment == F) %>% 
  select(-c(Q4.3, Q4.4, Q4.5), class=Q3.3, personality=Q3.4, grade=Q3.5)

treatment = smart_cleaned %>% 
  filter(Treatment == T) %>% 
  select(-c(Q3.3, Q3.4, Q3.5), class = Q4.3, personality=Q4.4, grade=Q4.5) 

data = rbind(control, treatment)
#write_csv(data, "data.csv")
```
```{r}
data2<-read.csv("data.csv", na.strings = c("", "NA"))
```
```{r}
data2 = na.omit(data2)
```
```{r}
#write_csv(data2, "cleaned_data.csv")
```
```{r}
dim(data2)
table(data2$grade)
summary(data2$grade_)
```

```{r}
# Convert GPA

data2$grade = ifelse(data2$grade == "A(3.75-4.0)", 9,
                     ifelse(data2$grade == "A-(3.5-3.75)", 8,
                            ifelse(data2$grade == "B+(3.25-3.5)", 7,
                                   ifelse(data2$grade == "B(3.0-3.25)", 6,
                                          ifelse(data2$grade == "B-(2.75-3.0)", 5,
                                                 ifelse(data2$grade == "C+(2.5-2.75)", 4,
                                                        ifelse(data2$grade == "C(2.25-2.5)", 3,
                                                               ifelse(data2$grade == "C-(2.0-2.25)", 2,
                                                                      ifelse(data2$grade == "Prefer not to say", NA, 1)
                                                               ))))))))
table(data2$grade)
```

```{r}
# Convert GPA_P

data2$grade_p = ifelse(data2$grade_p == "A(3.75-4.0)", 9,
                     ifelse(data2$grade_p == "A-(3.5-3.75)", 8,
                            ifelse(data2$grade_p == "B+(3.25-3.5)", 7,
                                   ifelse(data2$grade_p == "B(3.0-3.25)", 6,
                                          ifelse(data2$grade_p == "B-(2.75-3.0)", 5,
                                                 ifelse(data2$grade_p == "C+(2.5-2.75)", 4,
                                                        ifelse(data2$grade_p == "C(2.25-2.5)", 3,
                                                               ifelse(data2$grade_p == "C-(2.0-2.25)", 2,
                                                                      ifelse(data2$grade_p == "Prefer not to say", NA,
                                                                             1)))))))))
table(data2$grade_p)
```

```{r}
# Convert GPA_baseline

data2$grade_baseline = ifelse(data2$grade_baseline == "A(3.75-4.0)", 9,
                     ifelse(data2$grade_baseline == "A-(3.5-3.75)", 8,
                            ifelse(data2$grade_baseline == "B+(3.25-3.5)", 7,
                                   ifelse(data2$grade_baseline == "B(3.0-3.25)", 6,
                                          ifelse(data2$grade_baseline == "B-(2.75-3.0)", 5,
                                                 ifelse(data2$grade_baseline == "C+(2.5-2.75)", 4,
                                                        ifelse(data2$grade_baseline == "C(2.25-2.5)", 3,
                                                               ifelse(data2$grade_baseline == "C-(2.0-2.25)", 2,
                                                                      ifelse(data2$grade_baseline == "Prefer not to say", NA,
                                                                             1)))))))))
table(data2$grade_baseline)
```
```{r}
data2$gender_p = ifelse(data2$gender_p == "Male", 1,
                 ifelse(data2$gender_p == "Female", 0, NA))

table(data2$gender_p)
```

```{r}
data2$personality_baseline = ifelse(data2$personality_baseline == "Logical", 1,
                             ifelse(data2$personality_baseline == "Emotional", 0, NA))

table(data2$personality_baseline)
```

```{r}
data2$personality_p = ifelse(data2$personality_p == "Logical", 1,
                             ifelse(data2$personality_p == "Emotional", 0, NA))

table(data2$personality_p)
```

```{r}
data2$personality = ifelse(data2$personality == "Logical", 1,
                             ifelse(data2$personality == "Emotional", 0, NA))

table(data2$personality)
```

```{r}
write_csv(data2, "data2.csv")
```





###############################################################################
```{r}

```


We have one optional question in the end of our survey to ask whether people can detect our purpose or not, and they can take a guess. 
```{r}
guess <- read_csv("glasses.csv")
```
```{r}
names(guess)
```
```{r}
names(guess) <- "purpose_guess"
```




